codeInput.plugins.AutoCloseBrackets=class extends codeInput.Plugin{bracketPairs=[];bracketsOpenedStack=[];constructor(e={"(":")","[":"]","{":"}"}){super([]),this.bracketPairs=e}afterElementsAdded(e){e.textareaElement.addEventListener("keydown",t=>{this.checkBackspace(e,t)}),e.textareaElement.addEventListener("input",t=>{this.checkBrackets(e,t)})}checkBrackets(e,t){if(t.data==e.textareaElement.value[e.textareaElement.selectionStart])for(let a in this.bracketPairs){let n=this.bracketPairs[a];if(t.data==n){e.textareaElement.selectionStart=e.textareaElement.selectionEnd+=1,t.preventDefault();break}}else if(t.data in this.bracketPairs){let r=this.bracketPairs[t.data];document.execCommand("insertText",!1,r),e.textareaElement.selectionStart=e.textareaElement.selectionEnd-=1}else if('"'===t.data){let l=e.textareaElement.value,s=e.textareaElement.selectionStart;e.textareaElement.value=l.slice(0,s)+'"'+l.slice(s),e.selectionStart=s,e.selectionEnd=s}}checkBackspace(e,t){if("Backspace"==t.key&&e.textareaElement.selectionStart==e.textareaElement.selectionEnd){let a=this.bracketPairs[e.textareaElement.value[e.textareaElement.selectionStart-1]];null!=a&&e.textareaElement.value[e.textareaElement.selectionStart]==a&&(e.textareaElement.selectionEnd=e.textareaElement.selectionStart+1,e.textareaElement.selectionStart-=1)}}};